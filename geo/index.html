<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <meta name="description" content="Ferramenta desenvolvida pelo SiBBr que faz a converção de coordenadas Geográficas.">
  <meta name="Conversor de dados Geográficas" content="Ferramenta desenvolvida pelo SiBBr que faz a converção de coordenadas Geográficas.">
      <link rel="shortcut icon" type="image/x-icon" href="https://ferramentas.sibbr.gov.br/attapublica/favicon.ico">

  <title>SiBBr | Conversor de Coordenadas Geográficas</title>

  <!-- Reset CSS -->
  <link href="css/reset.css" rel="stylesheet">

  <!-- Bootstrap core CSS -->
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet">

  <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  <link href="https://getbootstrap.com/assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="https://getbootstrap.com/examples/sticky-footer-navbar/sticky-footer-navbar.css" rel="stylesheet">

 <link href="https://ferramentas.sibbr.gov.br/cdn/css/nav-bar.css" media="all" rel="stylesheet" type="text/css" />
 <script type="text/javascript" charset="utf-8" src="https://ferramentas.sibbr.gov.br/cdn/js/menu-global.js"></script>

  <link href="css/conversor.css" media="all" rel="stylesheet" type="text/css" />

  <script src="https://getbootstrap.com/assets/js/ie-emulation-modes-warning.js"></script>

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->


      <!--  Font Awesome 4.6.3 by @davegandy - https://fontawesome.io - @fontawesome -->
      <link href="css/font-awesome.css" rel="stylesheet">

      <!-- google fonts  -->
      <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic,700,700italic,800,800italic' rel='stylesheet' type='text/css'>
      <link href='https://fonts.googleapis.com/css?family=Raleway:100,200,300,400,500,600,700,800,900' rel='stylesheet' type='text/css'>
      <link href='https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic' rel='stylesheet' type='text/css'>
      <script defer="defer" src="https://cdn.sibbr.gov.br/js/barra.js" type="text/javascript"></script>


    </head>

    <body>
      <div id="barra-brasil" style="background:#7F7F7F; height: 20px; padding:0 0 0 10px;display:block;">
        <ul id="menu-barra-temp" style="list-style:none;">
          <li style="display:inline; float:left;padding-right:10px; margin-right:10px; border-right:1px solid #EDEDED"><a href="http://brasil.gov.br" style="font-family:sans,sans-serif; text-decoration:none; color:white;">Portal do Governo Brasileiro</a></li>
          <li><a style="font-family:sans,sans-serif; text-decoration:none; color:white;" href="http://epwg.governoeletronico.gov.br/barra/atualize.html">Atualize sua Barra de Governo</a></li>
        </ul>
      </div>

      <!-- Fixed navbar -->

      <div class="container-fluid">
        <!-- Begin page content -->
        <div class="container">
          <div class="engloba-conteudo">


            <div class="col-md-12">
              <div class="content">

                <h2>Conversor de Coordenadas Geográficas</h2>

<div class="conversor">



<div class="btn_change">
<span class="gdtogms glyphicon glyphicon-transfer" aria-hidden="true"></span>


<span style="display: none;" class="gmstogd glyphicon glyphicon-transfer" aria-hidden="true"></span>
</div>




<div class="row">
<div class="col-md-6">

<h4 class="detipoCoordenada">Grau Decimal</h4>

<textarea name="points_in" id="input">-47.07611111111112,-22.831666666666667
-47.07611111111112,-30.831666666666667
</textarea>
</div>


<div class="col-md-6">
<h4 class="paratipoCoordenada">Grau, minuto e segundo</h4>
<textarea name="points_in" id="output" ></textarea>

</div>


<input id="clickMe" type="button" value="Converter" onclick="gd2gms('input', 'output');" />

</div>
</div>

              <img class="center marca-dagua-sibbr" src="https://cdn.sibbr.gov.br/img/logo.svg" alt="SiBBr - Sistema de Informação sobre a Biodiversidade Brasileira">
            </div><!-- Content -->
          </div><!-- col-md-8 -->


        </div><!-- engloba-conteudo -->
      </div><!-- container -->
    </div><!-- container-fuid -->
  <footer class="footer">
    <div class="container">
      <div class="row ">
        <div class="col-md-12">
          <img class="center" src="https://cdn.sibbr.gov.br/img/img-rodape-white.svg" alt="Ministerio da Ciencia, Tecnologia, Inovaçoes e Comunicaçoes" >
          <br />
        </div>
      </div>
    </div>
  </footer>



    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js" type="text/javascript"></script>

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="https://getbootstrap.com/assets/js/ie10-viewport-bug-workaround.js"></script>


  </body>

  <script>


$(".gdtogms").click(function () {
  $("textarea#input").val(`47W 04' 34" , 22S 49' 54"
47W 04' 34" , 30S 49' 54`);
  $("#clickMe").attr("onclick","gms2gd('input', 'output')");
  $(".detipoCoordenada").html(`Grau, minuto e segundo`);
  $(".paratipoCoordenada").html(`Grau Decimal`);
  $('.gmstogd').show();
  $('.gdtogms').hide();
});

$(".gmstogd").click(function () {

  $("textarea#input").val(`-47.07611111111112,-22.831666666666667
-47.07611111111112,-30.831666666666667`);
  $("#clickMe").attr("onclick","gd2gms('input', 'output')");
  $(".detipoCoordenada").html(`Grau Decimal`);
  $(".paratipoCoordenada").html(`Grau, minuto e segundo`);
  $('.gdtogms').show();
  $('.gmstogd').hide();
});


// script no fim do <body>, recomendação do explorador
//  d + m/60 + s/3600
function gms2gd(inputTextAreaID, outputTextAreaID) {
  var input = document.getElementById(inputTextAreaID).value;
  var gmsLines = gms(input);
  var gc = [];
  for (i = 0; i < gmsLines.length; i++) {
    // francisco bixao
    var long = Math.abs(gmsLines[i][0][0]) + Math.abs(gmsLines[i][0][1]/60) + Math.abs(gmsLines[i][0][2]/3600);
    var lat = Math.abs(gmsLines[i][1][0]) + Math.abs(gmsLines[i][1][1]/60) + Math.abs(gmsLines[i][1][2]/3600);
    gc[i] = [gmsLines[i][0][0] < 0?-1 * long:long, gmsLines[i][1][0] < 0?-1 * lat:lat];
  }
  document.getElementById(outputTextAreaID).value = gc.join("\n");
}

function gd2gms(inputTextAreaID, outputTextAreaID) {
  var input = document.getElementById(inputTextAreaID).value;
  var gdLines = gd(input);
  var gc = [];
  for (i = 0; i < gdLines.length; i++) {
    var d = gdLines[i][0] | 0;
    var m = ((gdLines[i][0] - d) * 60) | 0;
    var s = (gdLines[i][0] - d - m/60) * 3600;
    var long = Math.abs(d) + (gdLines[i][0] < 0?"W":"E") + " " + Math.abs(Math.round(m)) + "' " + Math.abs(Math.round(s)) + "\"";
    d = gdLines[i][1] | 0;
    m = ((gdLines[i][1] - d) * 60) | 0;
    s = (gdLines[i][1] - d - m/60) * 3600;
    var lat = Math.abs(d) + (gdLines[i][0] < 0?"S":"N") + " " + Math.abs(Math.round(m)) + "' " + Math.abs(Math.round(s)) + "\"";
    gc[i] = [long, lat];
  }
  document.getElementById(outputTextAreaID).value = gc.join("\n");
}

function detectSep(input, seps) {
  if (!Array.isArray(seps)) {
    return null;
  }
  // remove empty lines
  var lines = input.match(/[^\r\n]+/g);
  var sepCount = [];
  for (i = 0; i < seps.length; i++) {
    sepCount[seps[i]] = 0;
  }
  // split by separator
  for (i = 0; i < lines.length; i++) {
    for (j = 0; j < seps.length; j++) {
      sepCount[seps[j]] += lines[i].split(seps[j]).length;
    }
  }
  // select top sep
  var sep = "";
  var max = 0;
  for (var key in sepCount) {
    if (sepCount[key] > max) {
      max = sepCount[key];
      sep = key
    }
  }
  if (max == 0) {
    return null;
  }
  return sep;
}

function gd(input) {
  var sep = detectSep(input, [",", ";", "\t"]);
  if (sep == null) return sep;

  var gd = [];
  var lines = input.match(/[^\r\n]+/g);
  for (i = 0; i < lines.length; i++) {
    var longLat = lines[i].trim().split(sep);
    var long = longLat[0].trim();
    var lat = longLat[1].trim();
    gd[i] = [parseFloat(long), parseFloat(lat)];
  }
  return gd;
}

function gms(input) {
  var sep = detectSep(input, [",", ";", "\t"]);
  if (sep == null) return sep;

  var gms = [];
  var lines = input.match(/[^\r\n]+/g);
  for (i = 0; i < lines.length; i++) {
    lines[i] = lines[i].replace(/['"]/gi, "").trim();
    var longLat = lines[i].split(sep);
    longLat[0] = longLat[0].trim();
    longLat[1] = longLat[1].trim();
    var long = longLat[0].split(" ");
    var lat = longLat[1].split(" ");
    for (j = 0; j < long.length; j++) {
      if ( long[j].search(/[WOS]$/i) != -1 ) {
        long[j] = -1 * parseFloat(long[j].replace(/[WOES]$/i, ""));
      } else {
        long[j] = parseFloat(long[j].replace(/[OWES]$/i, ""));
      }
      if ( lat[j].search(/[WOS]$/i) != -1 ) {
        lat[j] = -1 * parseFloat(lat[j].replace(/[WOES]$/i, ""));
      } else {
        lat[j] = parseFloat(lat[j].replace(/[OWES]$/i, ""));
      }
    }
    gms[i] = [long, lat];
  }
  return gms;
}


</script>
</html>
